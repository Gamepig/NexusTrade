<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradingView Widget 測試 - NexusTrade</title>
    <style>
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: #ffffff;
        }
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 12px;
        }
        .widget-list {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }
        .widget-item {
            padding: 15px;
            background: #333;
            border-radius: 8px;
            border-left: 4px solid #00d4aa;
        }
        .widget-name {
            font-weight: 600;
            color: #00d4aa;
            margin-bottom: 5px;
        }
        .widget-desc {
            font-size: 14px;
            color: #b0b0b0;
            margin-bottom: 10px;
        }
        .test-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .test-link {
            padding: 6px 12px;
            background: #00d4aa;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 13px;
            transition: background 0.3s;
        }
        .test-link:hover {
            background: #00b894;
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            background: #1e1e1e;
            border-radius: 8px;
        }
        .debug-info {
            font-family: monospace;
            font-size: 12px;
            color: #888;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>📊 TradingView Widget 完整測試</h1>
        <p>測試單一貨幣詳情頁面的 7 個 TradingView Widget</p>
        
        <div class="widget-list">
            <div class="widget-item">
                <div class="widget-name">1. Symbol Info Widget</div>
                <div class="widget-desc">頂部基本資訊展示 - 即時價格、24h變化、基本統計</div>
                <div class="test-links">
                    <a href="http://localhost:3000/#/currency/BTCUSDT" class="test-link" target="_blank">測試 BTC</a>
                    <a href="http://localhost:3000/#/currency/ETHUSDT" class="test-link" target="_blank">測試 ETH</a>
                </div>
            </div>

            <div class="widget-item">
                <div class="widget-name">2. Advanced Chart Widget</div>
                <div class="widget-desc">主要圖表區域 - 完整技術分析圖表、多時間框架</div>
                <div class="test-links">
                    <a href="http://localhost:3000/#/currency/BTCUSDT" class="test-link" target="_blank">測試進階圖表</a>
                </div>
            </div>

            <div class="widget-item">
                <div class="widget-name">3. Company Profile Widget</div>
                <div class="widget-desc">貨幣背景資訊 - 加密貨幣簡介、關鍵數據</div>
                <div class="test-links">
                    <a href="http://localhost:3000/#/currency/BNBUSDT" class="test-link" target="_blank">測試 BNB 資訊</a>
                </div>
            </div>

            <div class="widget-item">
                <div class="widget-name">4. Technical Analysis Widget</div>
                <div class="widget-desc">技術分析信號 - 自動化交易信號和技術指標總結</div>
                <div class="test-links">
                    <a href="http://localhost:3000/#/currency/ETHUSDT" class="test-link" target="_blank">測試技術分析</a>
                </div>
            </div>

            <div class="widget-item">
                <div class="widget-name">5. Top Stories Widget</div>
                <div class="widget-desc">相關新聞 - 市場情緒分析和相關新聞動態</div>
                <div class="test-links">
                    <a href="http://localhost:3000/#/currency/BTCUSDT" class="test-link" target="_blank">測試新聞</a>
                </div>
            </div>

            <div class="widget-item">
                <div class="widget-name">6. Crypto Coins Heatmap Widget</div>
                <div class="widget-desc">市場概覽 - 整體加密貨幣市場表現視覺化熱力圖</div>
                <div class="test-links">
                    <a href="http://localhost:3000/#/currency/ADAUSDT" class="test-link" target="_blank">測試熱力圖</a>
                </div>
            </div>

            <div class="widget-item">
                <div class="widget-name">7. Cryptocurrency Market Widget</div>
                <div class="widget-desc">市場排行 - 前 10 大加密貨幣比較數據和排行榜</div>
                <div class="test-links">
                    <a href="http://localhost:3000/#/currency/SOLUSDT" class="test-link" target="_blank">測試排行榜</a>
                </div>
            </div>
        </div>

        <div class="status">
            <h3>測試狀態：</h3>
            <div id="test-results" class="debug-info">準備開始測試...</div>
        </div>

        <div class="status">
            <h3>Widget 配置資訊：</h3>
            <div class="debug-info">
                • 所有 Widget 使用繁體中文 (locale: "zh_TW")<br>
                • 統一深色主題 (colorTheme: "dark")<br>
                • 台灣時區設定 (timezone: "Asia/Taipei")<br>
                • 響應式設計支援 (autosize: true)<br>
                • 現代化嵌入方式 (腳本標籤 + JSON 配置)
            </div>
        </div>
    </div>

    <script>
        function updateTestResults() {
            const results = document.getElementById('test-results');
            results.innerHTML = '🔍 檢查系統狀態:<br>';
            
            // 檢查基本服務
            fetch('http://localhost:3000/api/market/symbols')
                .then(response => {
                    if (response.ok) {
                        results.innerHTML += '✅ 後端 API 服務正常<br>';
                        
                        // 檢查 TradingView 資源
                        return fetch('https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js');
                    } else {
                        throw new Error('API 服務異常');
                    }
                })
                .then(response => {
                    if (response.ok) {
                        results.innerHTML += '✅ TradingView 外部資源可訪問<br>';
                        results.innerHTML += '✅ 所有系統準備就緒<br>';
                        results.innerHTML += '<br><strong>🎯 可以開始測試 Widget 功能</strong><br>';
                        results.innerHTML += '點擊上方按鈕開啟貨幣詳情頁面，檢查 Widget 是否正常載入。';
                    } else {
                        throw new Error('TradingView 資源無法訪問');
                    }
                })
                .catch(error => {
                    results.innerHTML += `❌ 系統檢查失敗: ${error.message}<br>`;
                });
        }

        // 頁面載入完成後檢查狀態
        window.addEventListener('load', () => {
            setTimeout(updateTestResults, 1000);
        });
    </script>
</body>
</html>