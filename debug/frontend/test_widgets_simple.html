<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Widget Test</title>
    <style>
        body { background: #1a1a1a; color: white; font-family: Arial, sans-serif; padding: 20px; }
        .widget { margin: 20px 0; border: 1px solid #333; border-radius: 8px; overflow: hidden; }
        .widget-header { background: #2a2a2a; padding: 15px; font-weight: bold; }
        .widget-content { height: 400px; }
        .chart-content { height: 600px; }
    </style>
</head>
<body>
    <h1>🧪 簡單 Widget 測試 - ETHUSDT</h1>

    <div class="widget">
        <div class="widget-header">📈 Advanced Chart</div>
        <div class="widget-content chart-content">
            <div id="test-chart"></div>
        </div>
    </div>

    <div class="widget">
        <div class="widget-header">🔍 Technical Analysis</div>
        <div class="widget-content">
            <div id="test-technical"></div>
        </div>
    </div>

    <div class="widget">
        <div class="widget-header">📰 Top Stories</div>
        <div class="widget-content">
            <div id="test-stories"></div>
        </div>
    </div>

    <script>
        const symbol = 'BINANCE:ETHUSDT';
        
        function createWidget(containerId, widgetType, config) {
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <div class="tradingview-widget-container">
                    <div class="tradingview-widget-container__widget"></div>
                </div>
            `;
            
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = `https://s3.tradingview.com/external-embedding/embed-widget-${widgetType}.js`;
            script.async = true;
            script.innerHTML = JSON.stringify(config);
            container.appendChild(script);
            
            console.log(`✅ 創建 ${widgetType} Widget`);
        }
        
        function initWidgets() {
            console.log('🚀 開始初始化 Widget...');
            
            // Advanced Chart
            createWidget('test-chart', 'advanced-chart', {
                "width": "100%",
                "height": "600",
                "symbol": symbol,
                "interval": "D",
                "timezone": "Asia/Taipei",
                "theme": "dark",
                "style": "1",
                "locale": "zh_TW",
                "backgroundColor": "rgba(19, 23, 34, 1)",
                "allow_symbol_change": false,
                "studies": ["RSI@tv-basicstudies", "MACD@tv-basicstudies"]
            });
            
            setTimeout(() => {
                // Technical Analysis
                createWidget('test-technical', 'technical-analysis', {
                    "interval": "1D",
                    "width": "100%",
                    "isTransparent": true,
                    "height": "400",
                    "symbol": symbol,
                    "showIntervalTabs": true,
                    "locale": "zh_TW",
                    "colorTheme": "dark"
                });
            }, 2000);
            
            setTimeout(() => {
                // Top Stories
                createWidget('test-stories', 'timeline', {
                    "feedMode": "symbol",
                    "symbol": symbol,
                    "colorTheme": "dark",
                    "isTransparent": true,
                    "displayMode": "regular",
                    "width": "100%",
                    "height": "400",
                    "locale": "zh_TW"
                });
            }, 4000);
            
            console.log('🎉 所有 Widget 初始化完成');
        }
        
        window.addEventListener('load', () => {
            setTimeout(initWidgets, 1000);
        });
    </script>
</body>
</html>