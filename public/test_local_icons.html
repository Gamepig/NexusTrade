<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>本地圖標測試 - NexusTrade</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0f0f0f;
            color: white;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .section {
            background: #1a1a1a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #333;
        }
        .section h3 {
            color: #f7931a;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .icon-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            background: #2a2a2a;
            border-radius: 8px;
            border: 1px solid #444;
            transition: transform 0.2s ease;
        }
        .icon-item:hover {
            transform: translateY(-2px);
            border-color: #f7931a;
        }
        .icon-name {
            margin-top: 8px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .comparison-item {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .comparison-title {
            color: #f7931a;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .stats {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .stats h4 {
            color: #00d4aa;
            margin: 0 0 10px 0;
        }
        .success { color: #00d4aa; }
        .error { color: #ff4757; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🖼️ 本地加密貨幣圖標測試</h1>
        
        <div class="stats">
            <h4>📊 下載統計</h4>
            <p><span class="success">✅ 成功下載: <span id="success-count">43</span> 個圖標</span></p>
            <p><span class="success">🎯 覆蓋率: 97.7%</span></p>
            <p>📁 來源: CoinCap API (assets.coincap.io)</p>
        </div>

        <div class="section">
            <h3>1. 主要加密貨幣圖標</h3>
            <div class="icon-grid" id="major-crypto-icons">
                <!-- 動態載入 -->
            </div>
        </div>

        <div class="section">
            <h3>2. 穩定幣圖標</h3>
            <div class="icon-grid" id="stablecoin-icons">
                <!-- 動態載入 -->
            </div>
        </div>

        <div class="section">
            <h3>3. DeFi 代幣圖標</h3>
            <div class="icon-grid" id="defi-icons">
                <!-- 動態載入 -->
            </div>
        </div>

        <div class="section">
            <h3>4. 比較測試：本地圖標 vs 文字圖標</h3>
            <div class="comparison">
                <div class="comparison-item">
                    <div class="comparison-title">本地圖標 (優先)</div>
                    <div id="local-icon-demo"></div>
                </div>
                <div class="comparison-item">
                    <div class="comparison-title">文字圖標 (後備)</div>
                    <div id="text-icon-demo"></div>
                </div>
            </div>
        </div>

        <div class="section">
            <h3>5. 圖標品質測試</h3>
            <p>測試不同尺寸的圖標顯示效果：</p>
            <div style="display: flex; gap: 20px; align-items: center; margin: 20px 0;">
                <div id="btc-small"></div>
                <div id="btc-medium"></div>
                <div id="btc-large"></div>
                <div id="btc-xlarge"></div>
            </div>
            <p style="font-size: 12px; color: #aaa;">從左到右：24px, 32px, 48px, 64px</p>
        </div>
    </div>

    <script src="/js/crypto-icons-map.js"></script>
    <script>
        // 加密貨幣分類
        const cryptoCategories = {
            major: ['btc', 'eth', 'bnb', 'sol', 'ada', 'xrp', 'doge', 'dot', 'avax', 'matic', 'link', 'ltc'],
            stablecoins: ['usdt', 'usdc', 'busd', 'fdusd', 'dai'],
            defi: ['uni', 'aave', 'comp', 'mkr', 'snx', 'crv', 'yfi']
        };

        function createIconItem(symbol, size = 32) {
            const iconHtml = window.getCryptoIcon(symbol + 'USDT', size);
            return `
                <div class="icon-item">
                    ${iconHtml}
                    <div class="icon-name">${symbol.toUpperCase()}</div>
                </div>
            `;
        }

        function loadIconCategory(categoryId, symbols) {
            const container = document.getElementById(categoryId);
            let html = '';
            
            symbols.forEach(symbol => {
                html += createIconItem(symbol, 40);
            });
            
            container.innerHTML = html;
        }

        function testComparison() {
            // 本地圖標 (Bitcoin)
            const localContainer = document.getElementById('local-icon-demo');
            localContainer.innerHTML = window.getCryptoIcon('BTCUSDT', 64);
            
            // 模擬文字圖標 (假設沒有本地圖標)
            const textContainer = document.getElementById('text-icon-demo');
            const tempIconsLocal = window.CryptoIconsLocal;
            window.CryptoIconsLocal = {}; // 暫時清空本地圖標
            textContainer.innerHTML = window.getCryptoIcon('BTCUSDT', 64);
            window.CryptoIconsLocal = tempIconsLocal; // 恢復
        }

        function testSizes() {
            const sizes = [24, 32, 48, 64];
            const containers = ['btc-small', 'btc-medium', 'btc-large', 'btc-xlarge'];
            
            sizes.forEach((size, index) => {
                const container = document.getElementById(containers[index]);
                container.innerHTML = window.getCryptoIcon('BTCUSDT', size);
            });
        }

        function updateStats() {
            if (window.CryptoIconsLocal) {
                const count = Object.keys(window.CryptoIconsLocal).length;
                document.getElementById('success-count').textContent = count;
            }
        }

        // 初始化頁面
        window.addEventListener('load', () => {
            console.log('🖼️ 載入本地圖標測試頁面...');
            
            // 檢查圖標映射是否載入
            if (typeof window.getCryptoIcon !== 'function') {
                console.error('❌ getCryptoIcon 函數未載入');
                return;
            }
            
            if (!window.CryptoIconsLocal) {
                console.error('❌ 本地圖標映射未載入');
                return;
            }

            console.log(`✅ 載入了 ${Object.keys(window.CryptoIconsLocal).length} 個本地圖標`);
            
            // 載入各分類圖標
            loadIconCategory('major-crypto-icons', cryptoCategories.major);
            loadIconCategory('stablecoin-icons', cryptoCategories.stablecoins);
            loadIconCategory('defi-icons', cryptoCategories.defi);
            
            // 比較測試
            testComparison();
            
            // 尺寸測試
            testSizes();
            
            // 更新統計
            updateStats();
            
            console.log('🎉 本地圖標測試頁面載入完成！');
        });
    </script>
</body>
</html>