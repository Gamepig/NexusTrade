<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoCurrencyList çµ„ä»¶æ¸¬è©¦</title>
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding: 20px;
            background: var(--background-primary);
            color: var(--text-primary);
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 20px;
            background: var(--background-secondary);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
        }
        
        .test-title {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .test-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-size: 0.9rem;
        }
        
        .test-container {
            background: var(--background-primary);
            padding: 15px;
            border-radius: var(--border-radius-small);
            border: 1px solid var(--border-color);
        }
        
        .status-info {
            background: var(--background-tertiary);
            padding: 10px;
            border-radius: var(--border-radius-small);
            margin-bottom: 15px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .api-test {
            margin-top: 20px;
            padding: 15px;
            background: var(--background-tertiary);
            border-radius: var(--border-radius-small);
        }
        
        .api-result {
            background: var(--background-primary);
            padding: 10px;
            border-radius: var(--border-radius-small);
            font-family: var(--font-mono);
            font-size: 0.8rem;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª CryptoCurrencyList çµ„ä»¶æ¸¬è©¦</h1>
    <p>æ¸¬è©¦å¯é‡è¤‡ä½¿ç”¨çš„åŠ å¯†è²¨å¹£åˆ—è¡¨çµ„ä»¶åŠŸèƒ½</p>
    
    <!-- API ç«¯é»æ¸¬è©¦ -->
    <div class="test-section">
        <div class="test-title">ğŸ”Œ API ç«¯é»æ¸¬è©¦</div>
        <div class="test-description">æ¸¬è©¦æ–°å¢çš„ Binance API ç«¯é»æ˜¯å¦æ­£å¸¸å·¥ä½œ</div>
        
        <div class="api-test">
            <h4>24å°æ™‚å¸‚å ´çµ±è¨ˆ</h4>
            <button onclick="testMarketStats()">æ¸¬è©¦ /api/market/stats24h</button>
            <div id="stats-result" class="api-result"></div>
        </div>
        
        <div class="api-test">
            <h4>æ‰¹é‡åƒ¹æ ¼æ•¸æ“š</h4>
            <button onclick="testBatchPrices()">æ¸¬è©¦ /api/market/batch-prices</button>
            <div id="batch-result" class="api-result"></div>
        </div>
        
        <div class="api-test">
            <h4>ç†±é–€äº¤æ˜“å°</h4>
            <button onclick="testTrendingPairs()">æ¸¬è©¦ /api/market/trending</button>
            <div id="trending-result" class="api-result"></div>
        </div>
    </div>
    
    <!-- é¦–é æ¨¡å¼æ¸¬è©¦ -->
    <div class="test-section">
        <div class="test-title">ğŸ  é¦–é æ¨¡å¼æ¸¬è©¦ (å›ºå®š10å€‹è²¨å¹£)</div>
        <div class="test-description">æ¨¡æ“¬é¦–é çš„ HomeCryptoList çµ„ä»¶</div>
        <div class="status-info" id="home-status">åˆå§‹åŒ–ä¸­...</div>
        
        <div class="test-container">
            <div id="home-crypto-container" class="crypto-list-container">
                <!-- HomeCryptoList å°‡åœ¨é€™è£¡æ¸²æŸ“ -->
            </div>
        </div>
    </div>
    
    <!-- å¸‚å ´é é¢æ¨¡å¼æ¸¬è©¦ -->
    <div class="test-section">
        <div class="test-title">ğŸ“Š å¸‚å ´é é¢æ¨¡å¼æ¸¬è©¦ (ç„¡é™æ»¾å‹•200å€‹è²¨å¹£)</div>
        <div class="test-description">æ¨¡æ“¬å¸‚å ´é é¢çš„ CryptoCurrencyList çµ„ä»¶</div>
        <div class="status-info" id="market-status">åˆå§‹åŒ–ä¸­...</div>
        
        <div class="test-container">
            <div id="market-crypto-container" class="crypto-list-container">
                <!-- CryptoCurrencyList å°‡åœ¨é€™è£¡æ¸²æŸ“ -->
            </div>
        </div>
    </div>
    
    <!-- åœ–æ¨™æ¸¬è©¦ -->
    <div class="test-section">
        <div class="test-title">ğŸ–¼ï¸ åœ–æ¨™æ¸¬è©¦</div>
        <div class="test-description">æ¸¬è©¦æ–°çš„ cryptocurrencyliveprices.com åœ–æ¨™ä¾†æº</div>
        
        <div class="test-container">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <div id="icon-test-container">
                    <!-- åœ–æ¨™æ¸¬è©¦å°‡åœ¨é€™è£¡é¡¯ç¤º -->
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript æ¨¡çµ„ -->
    <script src="/js/lib/api.js"></script>
    <script src="/js/components/CryptoCurrencyList.js"></script>
    <script src="/js/components/HomeCryptoList.js"></script>
    
    <script>
        let homeCryptoList = null;
        let marketCryptoList = null;
        
        // API æ¸¬è©¦å‡½æ•¸
        async function testMarketStats() {
            const resultDiv = document.getElementById('stats-result');
            try {
                resultDiv.textContent = 'è¼‰å…¥ä¸­...';
                const response = await fetch('/api/market/stats24h');
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                resultDiv.textContent = `éŒ¯èª¤: ${error.message}`;
            }
        }
        
        async function testBatchPrices() {
            const resultDiv = document.getElementById('batch-result');
            try {
                resultDiv.textContent = 'è¼‰å…¥ä¸­...';
                const response = await fetch('/api/market/batch-prices?symbols=BTCUSDT,ETHUSDT,BNBUSDT');
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                resultDiv.textContent = `éŒ¯èª¤: ${error.message}`;
            }
        }
        
        async function testTrendingPairs() {
            const resultDiv = document.getElementById('trending-result');
            try {
                resultDiv.textContent = 'è¼‰å…¥ä¸­...';
                const response = await fetch('/api/market/trending?limit=5');
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                resultDiv.textContent = `éŒ¯èª¤: ${error.message}`;
            }
        }
        
        // åˆå§‹åŒ–æ¸¬è©¦
        function initializeTests() {
            console.log('ğŸ§ª é–‹å§‹åˆå§‹åŒ– CryptoCurrencyList çµ„ä»¶æ¸¬è©¦...');
            
            // åˆå§‹åŒ–é¦–é æ¨¡å¼
            const homeContainer = document.getElementById('home-crypto-container');
            const homeStatus = document.getElementById('home-status');
            
            if (typeof CryptoCurrencyList !== 'undefined') {
                try {
                    homeCryptoList = new CryptoCurrencyList({
                        container: homeContainer,
                        mode: 'fixed',
                        maxCoins: 10,
                        coinsPerPage: 10,
                        updateInterval: 15000,
                        onCoinClick: (symbol) => {
                            alert(`é¦–é æ¨¡å¼ - é»æ“Šè²¨å¹£: ${symbol}`);
                        }
                    });
                    homeStatus.textContent = 'âœ… é¦–é æ¨¡å¼åˆå§‹åŒ–æˆåŠŸ';
                    homeStatus.style.color = 'var(--secondary-color)';
                } catch (error) {
                    homeStatus.textContent = `âŒ é¦–é æ¨¡å¼åˆå§‹åŒ–å¤±æ•—: ${error.message}`;
                    homeStatus.style.color = 'var(--danger-color)';
                }
            } else {
                homeStatus.textContent = 'âŒ CryptoCurrencyList çµ„ä»¶æœªè¼‰å…¥';
                homeStatus.style.color = 'var(--danger-color)';
            }
            
            // åˆå§‹åŒ–å¸‚å ´é é¢æ¨¡å¼
            const marketContainer = document.getElementById('market-crypto-container');
            const marketStatus = document.getElementById('market-status');
            
            if (typeof CryptoCurrencyList !== 'undefined') {
                try {
                    marketCryptoList = new CryptoCurrencyList({
                        container: marketContainer,
                        mode: 'infinite',
                        maxCoins: 50, // ç‚ºäº†æ¸¬è©¦ï¼Œå…ˆé™åˆ¶åˆ°50å€‹
                        coinsPerPage: 25,
                        updateInterval: 15000,
                        onCoinClick: (symbol) => {
                            alert(`å¸‚å ´é é¢æ¨¡å¼ - é»æ“Šè²¨å¹£: ${symbol}`);
                        }
                    });
                    marketStatus.textContent = 'âœ… å¸‚å ´é é¢æ¨¡å¼åˆå§‹åŒ–æˆåŠŸ';
                    marketStatus.style.color = 'var(--secondary-color)';
                } catch (error) {
                    marketStatus.textContent = `âŒ å¸‚å ´é é¢æ¨¡å¼åˆå§‹åŒ–å¤±æ•—: ${error.message}`;
                    marketStatus.style.color = 'var(--danger-color)';
                }
            } else {
                marketStatus.textContent = 'âŒ CryptoCurrencyList çµ„ä»¶æœªè¼‰å…¥';
                marketStatus.style.color = 'var(--danger-color)';
            }
            
            // æ¸¬è©¦åœ–æ¨™
            testCryptoIcons();
        }
        
        // æ¸¬è©¦åœ–æ¨™
        function testCryptoIcons() {
            const container = document.getElementById('icon-test-container');
            const testCoins = [
                { symbol: 'BTCUSDT', name: 'Bitcoin' },
                { symbol: 'ETHUSDT', name: 'Ethereum' },
                { symbol: 'BNBUSDT', name: 'BNB' },
                { symbol: 'ADAUSDT', name: 'Cardano' },
                { symbol: 'SOLUSDT', name: 'Solana' }
            ];
            
            testCoins.forEach(coin => {
                const baseSymbol = coin.symbol.replace('USDT', '').toLowerCase();
                const baseName = coin.name.toLowerCase().replace(/\s+/g, '-');
                const iconUrl = `https://cryptocurrencyliveprices.com/img/${baseSymbol}-${baseName}.png`;
                
                const iconDiv = document.createElement('div');
                iconDiv.style.textAlign = 'center';
                iconDiv.style.padding = '10px';
                iconDiv.innerHTML = `
                    <img src="${iconUrl}" alt="${coin.name}" style="width: 32px; height: 32px; border-radius: 50%;" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div style="display: none; width: 32px; height: 32px; background: var(--background-tertiary); 
                         border-radius: 50%; display: flex; align-items: center; justify-content: center; 
                         font-size: 10px; margin: 0 auto;">${baseSymbol.toUpperCase()}</div>
                    <div style="margin-top: 5px; font-size: 0.8rem;">${coin.name}</div>
                    <div style="font-size: 0.7rem; color: var(--text-secondary);">${coin.symbol}</div>
                `;
                container.appendChild(iconDiv);
            });
        }
        
        // é é¢è¼‰å…¥å¾Œåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initializeTests, 500);
        });
    </script>
</body>
</html>