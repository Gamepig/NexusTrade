<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI åˆ†æç°¡å–®æ¸¬è©¦</title>
    <link rel="stylesheet" href="css/main.css?v=20250625fix5">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0e27;
            color: #ffffff;
            margin: 0;
            padding: 20px;
        }
        .debug-info {
            background: #1a1f3a;
            border: 1px solid #2d3748;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª AI åˆ†æç°¡å–®æ¸¬è©¦</h1>
    
    <div id="debug-log" class="debug-info">
        è¼‰å…¥ä¸­...<br>
    </div>
    
    <div id="ai-currency-analysis" style="margin: 20px 0;"></div>
    
    <script src="js/components/AICurrencyAnalysis.js?v=20250625fix5"></script>
    
    <script>
        const debugLog = document.getElementById('debug-log');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugLog.innerHTML += `[${timestamp}] ${message}<br>`;
            console.log(message);
        }
        
        async function testAIAnalysis() {
            try {
                log('ğŸ”„ é–‹å§‹æ¸¬è©¦ AI åˆ†æ...');
                
                // 1. æ¸¬è©¦ API ç›´æ¥èª¿ç”¨
                log('ğŸ“¡ æ¸¬è©¦ API ç«¯é»...');
                const response = await fetch('/api/ai/currency-analysis/BTCUSDT');
                const data = await response.json();
                
                if (data.status === 'success') {
                    log('âœ… API èª¿ç”¨æˆåŠŸ');
                    log(`ğŸ“Š æŠ€è¡“æŒ‡æ¨™æ•¸é‡: ${Object.keys(data.data.analysis.technicalAnalysis).length}`);
                    log(`ğŸ“ˆ è¶¨å‹¢æ–¹å‘: ${data.data.analysis.trend.direction}`);
                    log(`ğŸ¯ ä¿¡å¿ƒåº¦: ${data.data.analysis.trend.confidence}%`);
                    
                    // æª¢æŸ¥æ¯å€‹æŠ€è¡“æŒ‡æ¨™
                    const indicators = data.data.analysis.technicalAnalysis;
                    Object.keys(indicators).forEach(key => {
                        const indicator = indicators[key];
                        log(`  ğŸ“‹ ${key}: ${indicator.signal || 'N/A'} (å€¼: ${indicator.value || 'N/A'})`);
                    });
                    
                    // 2. æ¸¬è©¦å‰ç«¯çµ„ä»¶
                    log('ğŸ¨ åˆå§‹åŒ–å‰ç«¯çµ„ä»¶...');
                    const aiComponent = new AICurrencyAnalysis('ai-currency-analysis', 'BTCUSDT');
                    
                    // ç­‰å¾…çµ„ä»¶è¼‰å…¥
                    setTimeout(() => {
                        const container = document.getElementById('ai-currency-analysis');
                        if (container.innerHTML.includes('indicators-grid')) {
                            log('âœ… å‰ç«¯çµ„ä»¶è¼‰å…¥æˆåŠŸï¼ŒåŒ…å«æŠ€è¡“æŒ‡æ¨™ç¶²æ ¼');
                        } else if (container.innerHTML.includes('error')) {
                            log('âŒ å‰ç«¯çµ„ä»¶è¼‰å…¥å¤±æ•—ï¼Œé¡¯ç¤ºéŒ¯èª¤ç‹€æ…‹');
                        } else if (container.innerHTML.includes('loading')) {
                            log('â³ å‰ç«¯çµ„ä»¶ä»åœ¨è¼‰å…¥ä¸­...');
                        } else {
                            log('âš ï¸ å‰ç«¯çµ„ä»¶ç‹€æ…‹æœªçŸ¥');
                            log(`   å®¹å™¨å…§å®¹é•·åº¦: ${container.innerHTML.length} å­—ç¬¦`);
                        }
                    }, 3000);
                    
                } else {
                    log(`âŒ API èª¿ç”¨å¤±æ•—: ${data.message}`);
                }
                
            } catch (error) {
                log(`âŒ æ¸¬è©¦éç¨‹ç™¼ç”ŸéŒ¯èª¤: ${error.message}`);
                console.error('æ¸¬è©¦éŒ¯èª¤:', error);
            }
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œé–‹å§‹æ¸¬è©¦
        window.addEventListener('load', () => {
            log('ğŸš€ é é¢è¼‰å…¥å®Œæˆï¼Œé–‹å§‹æ¸¬è©¦...');
            testAIAnalysis();
        });
    </script>
</body>
</html>